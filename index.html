<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Processing Application - CM2030 Graphics Programming</title>
    <link rel="stylesheet" href="global.css">
    <link rel="stylesheet" href="voiceStyles.css">
    <link rel="stylesheet" href="saveStyles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
    <script src="https://unpkg.com/ml5@1/dist/ml5.min.js"></script>

</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ðŸŽ¨ Advanced Image Processing Studio</h1>
            <p>BSc Computer Science - CM2030 Graphics Programming Assignment</p>
        </header>

        <div class="controls-panel">
            <div class="control-group">
                <button id="captureBtn" class="btn-primary">ðŸ“¸ Capture Image</button>
                <button id="toggleCamera" class="btn-secondary">ðŸ“¹ Toggle Camera</button>
                <button id="saveBtn" class="btn-save">ðŸ’¾ Save Images</button>
            </div>
            
            <div class="control-group">
                <label>Red Channel Threshold:</label>
                <input type="range" id="redThreshold" min="0" max="255" value="128" class="slider">
                <span id="redValue">128</span>
            </div>
            
            <div class="control-group">
                <label>Green Channel Threshold:</label>
                <input type="range" id="greenThreshold" min="0" max="255" value="128" class="slider">
                <span id="greenValue">128</span>
            </div>
            
            <div class="control-group">
                <label>Blue Channel Threshold:</label>
                <input type="range" id="blueThreshold" min="0" max="255" value="128" class="slider">
                <span id="blueValue">128</span>
            </div>
            
            <div class="control-group">
                <label>HSV Threshold:</label>
                <input type="range" id="hsvThreshold" min="0" max="255" value="128" class="slider">
                <span id="hsvValue">128</span>
            </div>
            
            <div class="control-group">
                <label>Lab Threshold:</label>
                <input type="range" id="labThreshold" min="0" max="255" value="128" class="slider">
                <span id="labValue">128</span>
            </div>
        </div>

        <div class="face-controls">
            <h3>ðŸŽ­ Face Filter Controls</h3>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="0">0 - Original</button>
                <button class="filter-btn" data-filter="1">1 - Grayscale</button>
                <button class="filter-btn" data-filter="2">2 - Blur</button>
                <button class="filter-btn" data-filter="3">3 - Color Space</button>
                <button class="filter-btn" data-filter="4">4 - Pixelate</button>
            </div>
            <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                Use keyboard keys 0-4, click buttons, or voice commands to change face filters
            </p>
        </div>

        <div id="canvasContainer" style="display: none;"></div>

        <div class="image-grid" id="imageGrid">
        </div>

        <div class="status-panel">
            <div id="statusText">Ready to capture image...</div>
            <div class="fps-counter">FPS: <span id="fpsCounter">60</span></div>
        </div>
    </div>

    <!-- Save Modal -->
    <div id="saveModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ðŸ“¥ Save Processed Images</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <p>Choose which processed image you'd like to save:</p>
                
                <div class="image-options">
                    <div class="image-option" data-type="original">
                        <div class="option-preview" id="preview-original"></div>
                        <label>Webcam Image</label>
                    </div>
                    <div class="image-option" data-type="grayscale">
                        <div class="option-preview" id="preview-grayscale"></div>
                        <label>Grayscale + Brightness</label>
                    </div>
                    <div class="image-option" data-type="redChannel">
                        <div class="option-preview" id="preview-redChannel"></div>
                        <label>Red Channel</label>
                    </div>
                    <div class="image-option" data-type="greenChannel">
                        <div class="option-preview" id="preview-greenChannel"></div>
                        <label>Green Channel</label>
                    </div>
                    <div class="image-option" data-type="blueChannel">
                        <div class="option-preview" id="preview-blueChannel"></div>
                        <label>Blue Channel</label>
                    </div>
                    <div class="image-option" data-type="redThreshold">
                        <div class="option-preview" id="preview-redThreshold"></div>
                        <label>Red Threshold</label>
                    </div>
                    <div class="image-option" data-type="greenThreshold">
                        <div class="option-preview" id="preview-greenThreshold"></div>
                        <label>Green Threshold</label>
                    </div>
                    <div class="image-option" data-type="blueThreshold">
                        <div class="option-preview" id="preview-blueThreshold"></div>
                        <label>Blue Threshold</label>
                    </div>
                    <div class="image-option" data-type="originalRepeat">
                        <div class="option-preview" id="preview-originalRepeat"></div>
                        <label>Webcam Copy</label>
                    </div>
                    <div class="image-option" data-type="hsvConversion">
                        <div class="option-preview" id="preview-hsvConversion"></div>
                        <label>HSV Color Space</label>
                    </div>
                    <div class="image-option" data-type="labConversion">
                        <div class="option-preview" id="preview-labConversion"></div>
                        <label>Lab Color Space</label>
                    </div>
                    <div class="image-option" data-type="hsvThreshold">
                        <div class="option-preview" id="preview-hsvThreshold"></div>
                        <label>HSV Threshold</label>
                    </div>
                    <div class="image-option" data-type="labThreshold">
                        <div class="option-preview" id="preview-labThreshold"></div>
                        <label>Lab Threshold</label>
                    </div>
                    <div class="image-option" data-type="faceDetection">
                        <div class="option-preview" id="preview-faceDetection"></div>
                        <label>Face Detection</label>
                    </div>
                </div>

                <div class="save-options">
                    <div>
                        <label for="imageFormat">Format:</label>
                        <select id="imageFormat">
                            <option value="png">PNG</option>
                            <option value="jpeg">JPEG</option>
                            <option value="webp">WebP</option>
                        </select>
                    </div>
                    <div>
                        <label for="imageQuality">Quality:</label>
                        <input type="range" id="imageQuality" min="0.1" max="1" step="0.1" value="0.9">
                        <span id="qualityValue">90%</span>
                    </div>
                </div>

                <div class="bulk-save-section">
                    <h4>Bulk Save</h4>
                    <button class="bulk-save-btn" onclick="saveAllImages()">Save All Images</button>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancelSave" class="btn-secondary">Cancel</button>
                <button id="confirmSave" class="btn-primary" disabled>Save Selected Image</button>
            </div>
        </div>
    </div>

    <!-- Voice Control Integration and other Script Files  -->
    <script src="voiceControl.js"></script>
    <script src="saveImage.js"></script>
    <script src="script.js"></script>
</body>
</html>